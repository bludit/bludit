<?php defined('BLUDIT') or die('Bludit CMS.');

// ============================================================================
// Check role
// ============================================================================

checkRole(array('admin'));

// ============================================================================
// Functions
// ============================================================================

// ============================================================================
// Main before POST
// ============================================================================

// ============================================================================
// POST Method
// ============================================================================

if ($_SERVER['REQUEST_METHOD'] == 'POST') {
	if ($_POST['action']=='delete') {
		deleteTag($_POST);
	} elseif ($_POST['action']=='edit') {
		editTag($_POST);
	}

	Redirect::page('tags');
}

// ============================================================================
// Main after POST
// ============================================================================
$tagKey = $layout['parameters'];

if (!$tags->exists($tagKey)) {
	Log::set(__METHOD__.LOG_SEP.'Error occurred when trying to get the tag: '.$tagKey);
	Redirect::page('tags');
}

$tagMap = $tags->getMap($tagKey);

// Title of the page
$layout['title'] .= ' - '.$L->g('Edit Tag').' [ '.$tagMap['name'] . ' ] ';
